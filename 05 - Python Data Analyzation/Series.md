# ğŸ§ª Pandas Series å»ºç«‹èˆ‡åŸºæœ¬æ“ä½œæ•™å­¸

```python
# è¼‰å…¥ pandas å¥—ä»¶
import pandas as pd

# å»ºç«‹ Series ä¸¦æŒ‡å®šç´¢å¼•èˆ‡åç¨±
s = pd.Series([10, 2, 3, 4, 5], index=['A', 'B', 'C', 'D', 'E'], name='æœˆä»½')
print(s)
```

```python
# ä½¿ç”¨å­—å…¸å»ºç«‹ Series
s = pd.Series({"a": 1, "b": 2, "c": 3, "d": 4, "e": 5})

# å¾ç¾æœ‰ Series æ“·å–éƒ¨åˆ†è³‡æ–™
s2 = pd.Series([10, 2, 3, 4, 5], index=['A', 'B', 'C', 'D', 'E'], name='æœˆä»½')
s1 = pd.Series(s2, index=["A", "C"])
print(s1)
```

# Series çš„å±¬æ€§èˆ‡å­˜å–æ–¹æ³•
```python

print(s.loc['a'])   # é¡¯å¼ç´¢å¼• (label-based)
print(s.iloc[0])    # éš±å¼ç´¢å¼• (position-based)
print(s.at['a'])    # ä½¿ç”¨æ¨™ç±¤å¿«é€Ÿè¨ªå•å–®ä¸€å…ƒç´ 
print(s.iat[0])     # ä½¿ç”¨ä½ç½®å¿«é€Ÿè¨ªå•å–®ä¸€å…ƒç´ 
```
## è¨ªå•èˆ‡ç¯©é¸è³‡æ–™
```python

s['f'] = 6
print(s.head(2))    # å–å‰å…©å€‹å…ƒç´ 
print(s.tail(1))    # å–æœ€å¾Œä¸€å€‹å…ƒç´ 
```
## å¸¸è¦‹æ–¹æ³•ï¼šç¼ºå¤±å€¼ã€çµ±è¨ˆåˆ†æ
```python

import numpy as np

s = pd.Series([10, 2, np.nan, None, 3, 4, 5], index=['A', 'B', 'C', 'D', 'E', 'F', 'G'], name='data')
```

```python
s.head(3)           # å‰3 row
s.tail(2)           # å¾Œ2 row
s.describe()        # æ•˜è¿°çµ±è¨ˆæ‘˜è¦
s.count()           # é NaN å€¼æ•¸é‡
print(s.keys())     # è¿”å›ç´¢å¼•ç‰©ä»¶ï¼ˆç­‰åŒ s.indexï¼‰
print(s.index)      # ç´¢å¼•å±¬æ€§
print(s.isna())     # æ˜¯å¦ç‚º NaN
s.isin([4, 5, 6])   # æ˜¯å¦ç‚ºæŒ‡å®šå€¼ä¹‹ä¸€
```
## åŸºæœ¬çµ±è¨ˆæŒ‡æ¨™
```python

print(s.mean())     # å¹³å‡å€¼
print(s.sum())      # ç¸½å’Œ
print(s.std())      # æ¨™æº–å·®
print(s.var())      # è®Šç•°æ•¸
print(s.min())      # æœ€å°å€¼
print(s.max())      # æœ€å¤§å€¼
print(s.median())   # ä¸­ä½æ•¸
```
## åˆ†ä½æ•¸ã€çœ¾æ•¸ã€å‡ºç¾æ¬¡æ•¸èˆ‡å»é‡
```python
print(s.quantile(0.8))       # å–å¾— 80% åˆ†ä½æ•¸çš„å€¼
s['H'] = 4                   # æ–°å¢ä¸€å€‹ç´¢å¼•ç‚º 'H' çš„å…ƒç´ ï¼Œå…¶å€¼ç‚º 4
print(s.mode())              # å–å¾—å‡ºç¾æ¬¡æ•¸æœ€å¤šçš„å€¼ï¼ˆçœ¾æ•¸ï¼‰ï¼Œå¯èƒ½å›å‚³å¤šå€‹å€¼
print(s.value_counts())      # å›å‚³æ¯å€‹å€¼çš„å‡ºç¾æ¬¡æ•¸ï¼ˆç”±å¤§åˆ°å°æ’åºï¼‰
s.drop_duplicates()          # å›å‚³å»é™¤é‡è¤‡å€¼å¾Œçš„æ–° Seriesï¼ˆä¸æœƒä¿®æ”¹åŸ Seriesï¼‰
s.unique()                   # å›å‚³æ‰€æœ‰å”¯ä¸€å€¼çµ„æˆçš„ ndarray
print(s.nunique())           # å›å‚³å”¯ä¸€å€¼çš„æ•¸é‡ï¼ˆå³å»é‡å¾Œçš„å…ƒç´ å€‹æ•¸ï¼‰
```
	6.000000000000001 
	0  4
	Name: æœˆä»½, dtype: int64 
	æœˆä»½ 
	4 2 
	10 1 
	2 1 
	3 1 
	5 1 
	Name: count, dtype: int64 
	5
## æ’åºæ“ä½œ
```python

s.sort_index()      # æŒ‰ç´¢å¼•æ’åº
s.sort_values()     # æŒ‰å€¼æ’åº
```
# å¯¦ä¾‹æ“ä½œ
## â˜€ï¸ æº«åº¦è³‡æ–™çµ±è¨ˆåˆ†æ
```python

# å•é¡Œï¼šå¦‚ä½•è¨ˆç®—ä¸€å‘¨ä¸­æº«åº¦è¶…é30åº¦çš„å¤©æ•¸ï¼Ÿ
temperatures = pd.Series([28, 31, 29, 32, 30, 27, 33],
                         index=['é€±ä¸€', 'é€±äºŒ', 'é€±ä¸‰', 'é€±å››', 'é€±äº”', 'é€±å…­', 'é€±æ—¥'])
print('è¶…é30åº¦çš„å¤©æ•¸ï¼š', temperatures[temperatures > 30].count())

# å•é¡Œï¼šå¦‚ä½•è¨ˆç®—ä¸€å‘¨çš„å¹³å‡æº«åº¦ï¼Ÿ
print('å¹³å‡æº«åº¦ï¼š', temperatures.mean())

# å•é¡Œï¼šå¦‚ä½•å°‡ä¸€å‘¨çš„æº«åº¦å¾é«˜åˆ°ä½æ’åºï¼Ÿ
print('å¾é«˜åˆ°ä½æ’åºï¼š', temperatures.sort_values(ascending=False))

# å•é¡Œï¼šå¦‚ä½•æ‰¾å‡ºæº«åº¦è®ŠåŒ–æœ€å¤§çš„å…©å¤©ï¼Ÿ
print('æº«åº¦è®ŠåŒ–æœ€å¤§çš„å…©å¤©', *(temperatures.diff().abs().sort_values(ascending=False).keys()[:2]))
```
```python
'''
è¶…é30åº¦çš„å¤©æ•¸ï¼š 3 
å¹³å‡æº«åº¦ï¼š 30.0 
å¾é«˜åˆ°ä½æ’åºï¼š 
é€±æ—¥ 33 
é€±å›› 32
é€±äºŒ 31
é€±äº” 30 
é€±ä¸‰ 29 
é€±ä¸€ 28 
é€±å…­ 27 
dtype: int64 
æº«åº¦è®ŠåŒ–æœ€å¤§çš„å…©å¤© é€±æ—¥ é€±äºŒ
'''
```

## ğŸ“Š è‚¡ç¥¨åƒ¹æ ¼åˆ†æ
```python

# å•é¡Œï¼šå¦‚ä½•è¨ˆç®—æ¯æ—¥è‚¡åƒ¹çš„æ—¥æ”¶ç›Šç‡ï¼Ÿ
prices = pd.Series([102.3, 103.5, 105.1, 104.8, 106.2, 107.0, 106.5, 108.1, 109.3, 110.2],
                   index=pd.date_range('2023-01-01', periods=10))
returns = prices.pct_change()

# å•é¡Œï¼šå“ªä¸€å¤©çš„æ”¶ç›Šç‡æœ€é«˜ï¼Ÿ
print('æ”¶ç›Šç‡æœ€é«˜æ—¥æœŸ:', returns.idxmax())

# å•é¡Œï¼šå“ªä¸€å¤©çš„æ”¶ç›Šç‡æœ€ä½ï¼Ÿ
print('æ”¶ç›Šç‡æœ€ä½æ—¥æœŸ:', returns.idxmin())

# å•é¡Œï¼šå¦‚ä½•è¨ˆç®—æ”¶ç›Šç‡çš„æ³¢å‹•ç‡ï¼ˆæ¨™æº–å·®ï¼‰ï¼Ÿ
print('æ³¢å‹•ç‡:', returns.std())
```
```python
'''
æ”¶ç›Šç‡æœ€é«˜æ—¥æœŸ: 2023-01-03 00:00:00
æ”¶ç›Šç‡æœ€ä½æ—¥æœŸ: 2023-01-07 00:00:00 
æ³¢å‹•ç‡: 0.007373623845361105
'''
```

## ğŸ›’ éŠ·å”®è³‡æ–™åˆ†æ
```python

# å•é¡Œï¼šå¦‚ä½•è¨ˆç®—æ¯å­£åº¦çš„å¹³å‡éŠ·å”®é¡ï¼Ÿ
sales = pd.Series([120, 135, 145, 160, 155, 170, 180, 175, 190, 200, 210, 220],
                  index=pd.date_range('2022-01-01', periods=12, freq='MS'))
print(sales.resample('QS').mean())  # æ¯å­£åº¦å¹³å‡

# å•é¡Œï¼šå¦‚ä½•æ‰¾å‡ºéŠ·é‡æœ€é«˜çš„æœˆä»½ï¼Ÿ
print('éŠ·é‡æœ€é«˜çš„æœˆä»½', sales.idxmax())

# å•é¡Œï¼šå¦‚ä½•è¨ˆç®—æœˆç’°æ¯”çš„å¢é•·ç‡ï¼Ÿ
print('æœˆç’°æ¯”çš„å¢é•·ç‡')
sales.pct_change()

# å•é¡Œï¼šå¦‚ä½•æ‰¾å‡ºé€£çºŒä¸‰å€‹æœˆä»¥ä¸ŠéŠ·å”®é¡æŒçºŒå¢é•·çš„æœˆä»½ï¼Ÿ
mask = sales.pct_change() > 0
print(mask[mask.rolling(3).sum() == 3].keys().tolist())
```
```python
'''
2022-01-01 133.333333 
2022-04-01 161.666667 
2022-07-01 181.666667
2022-10-01 210.000000 
Freq: QS-JAN, dtype: float64 
éŠ·é‡æœ€é«˜çš„æœˆä»½ 2022-12-01 00:00:00 
æœˆç’°æ¯”çš„å¢é•·ç‡ 
[Timestamp('2022-04-01 00:00:00'), Timestamp('2022-11-01 00:00:00'), Timestamp('2022-12-01 00:00:00')]
'''
```

## â±ï¸ æ¯å°æ™‚éŠ·å”®è³‡æ–™åˆ†æ
```python

# å•é¡Œï¼šå¦‚ä½•è¨ˆç®—ç‡Ÿæ¥­æ™‚é–“èˆ‡éç‡Ÿæ¥­æ™‚é–“çš„éŠ·å”®æ¯”ä¾‹ï¼Ÿ
np.random.seed(42)
h = pd.Series(np.random.randint(0, 100, 24),
              index=pd.date_range('2025-01-01', periods=24, freq='h'))

# æŒ‰å¤©çµ±è¨ˆéŠ·å”®ç¸½é¡
day_sales = h.resample('D').sum()

# ç‡Ÿæ¥­æ™‚é–“ç‚º08:00åˆ°22:00
work_hour_mask = (h.index.hour >= 8) & (h.index.hour <= 22)
work_sales = h[work_hour_mask]
off_sales = h[~work_hour_mask]

# è¨ˆç®—ç‡Ÿæ¥­æ™‚é–“éŠ·å”®ç¸½é¡èˆ‡éç‡Ÿæ¥­æ™‚é–“éŠ·å”®ç¸½é¡çš„æ¯”ä¾‹
print('ç‡Ÿæ¥­/éç‡Ÿæ¥­éŠ·å”®æ¯”ä¾‹:', work_sales.sum() / off_sales.sum())

# æ‰¾å‡ºéŠ·å”®é¡æœ€é«˜çš„å‰ä¸‰å€‹å°æ™‚
print('éŠ·å”®é¡æœ€é«˜çš„3å€‹å°æ™‚:', h.nlargest(3).keys())
```
```python
'''
ç‡Ÿæ¥­/éç‡Ÿæ¥­éŠ·å”®æ¯”ä¾‹: 1.4294354838709677 
éŠ·å”®é¡æœ€é«˜çš„3å€‹å°æ™‚: DatetimeIndex(['2025-01-01 11:00:00', '2025-01-01 01:00:00', '2025-01-01 10:00:00'], dtype='datetime64[ns]', freq=None)
'''
```